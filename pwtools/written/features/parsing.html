<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Parsing code output and using containers &#8212; pwtools  documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Installation" href="../install.html" />
    <link rel="prev" title="Parameter studies" href="param_study.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../install.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="param_study.html" title="Parameter studies"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pwtools  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Features</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Parsing code output and using containers</a><ul>
<li><a class="reference internal" href="#available-parsers">Available parsers</a></li>
<li><a class="reference internal" href="#container-classes-structure-and-trajectory">Container classes <code class="docutils literal"><span class="pre">Structure</span></code> and <code class="docutils literal"><span class="pre">Trajectory</span></code></a></li>
<li><a class="reference internal" href="#high-level-parsing-functions">High-level parsing functions</a></li>
<li><a class="reference internal" href="#units">Units</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="param_study.html"
                        title="previous chapter">Parameter studies</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../install.html"
                        title="next chapter">Installation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/written/features/parsing.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="parsing-code-output-and-using-containers">
<h1>Parsing code output and using containers<a class="headerlink" href="#parsing-code-output-and-using-containers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="available-parsers">
<span id="parser-classes"></span><h2>Available parsers<a class="headerlink" href="#available-parsers" title="Permalink to this headline">¶</a></h2>
<p>A core feature of pwtools is a set of parsers for commonly used atomistic
simulation codes. The parsers are located in <a class="reference internal" href="../../generated/api/parse.html#module-pwtools.parse" title="pwtools.parse"><code class="xref py py-mod docutils literal"><span class="pre">parse</span></code></a>. These
parsers are available:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.CifFile.html#pwtools.parse.CifFile" title="pwtools.parse.CifFile"><code class="xref py py-class docutils literal"><span class="pre">CifFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PDBFile.html#pwtools.parse.PDBFile" title="pwtools.parse.PDBFile"><code class="xref py py-class docutils literal"><span class="pre">PDBFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PwSCFOutputFile.html#pwtools.parse.PwSCFOutputFile" title="pwtools.parse.PwSCFOutputFile"><code class="xref py py-class docutils literal"><span class="pre">PwSCFOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PwMDOutputFile.html#pwtools.parse.PwMDOutputFile" title="pwtools.parse.PwMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">PwMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PwVCMDOutputFile.html#pwtools.parse.PwVCMDOutputFile" title="pwtools.parse.PwVCMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">PwVCMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.CpmdSCFOutputFile.html#pwtools.parse.CpmdSCFOutputFile" title="pwtools.parse.CpmdSCFOutputFile"><code class="xref py py-class docutils literal"><span class="pre">CpmdSCFOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.CpmdMDOutputFile.html#pwtools.parse.CpmdMDOutputFile" title="pwtools.parse.CpmdMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">CpmdMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kSCFOutputFile.html#pwtools.parse.Cp2kSCFOutputFile" title="pwtools.parse.Cp2kSCFOutputFile"><code class="xref py py-class docutils literal"><span class="pre">Cp2kSCFOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kMDOutputFile.html#pwtools.parse.Cp2kMDOutputFile" title="pwtools.parse.Cp2kMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">Cp2kMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kDcdMDOutputFile.html#pwtools.parse.Cp2kDcdMDOutputFile" title="pwtools.parse.Cp2kDcdMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">Cp2kDcdMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kRelaxOutputFile.html#pwtools.parse.Cp2kRelaxOutputFile" title="pwtools.parse.Cp2kRelaxOutputFile"><code class="xref py py-class docutils literal"><span class="pre">Cp2kRelaxOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.LammpsTextMDOutputFile.html#pwtools.parse.LammpsTextMDOutputFile" title="pwtools.parse.LammpsTextMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">LammpsTextMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.LammpsDcdMDOutputFile.html#pwtools.parse.LammpsDcdMDOutputFile" title="pwtools.parse.LammpsDcdMDOutputFile"><code class="xref py py-class docutils literal"><span class="pre">LammpsDcdMDOutputFile</span></code></a></div>
</div>
</div></blockquote>
<p>The parsers called <code class="docutils literal"><span class="pre">*OutpoutFile</span></code> are for parsing simulation code output. The
others parse structure files (cif and pdb).</p>
<p>All parsers have a common API and can be used like</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">PwSCFOutputFile</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or call all get_*() methods at once and access attributes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">cell</span>
</pre></div>
</div>
<p>The problem with using the parsers directly is that there are of course
differences between the codes. For instance, each one uses different units
(Bohr, Angstrom, Ry, Ha, eV, ...). Also, not all structure attributes are
contained in the output of all codes. For example,
<a class="reference internal" href="../../generated/api/pwtools.parse.PwSCFOutputFile.html#pwtools.parse.PwSCFOutputFile" title="pwtools.parse.PwSCFOutputFile"><code class="xref py py-class docutils literal"><span class="pre">PwSCFOutputFile</span></code></a> will parse Cartesian atomic coordinates into
<code class="docutils literal"><span class="pre">pp.coords</span></code> and the unit cell into <code class="docutils literal"><span class="pre">pp.cell</span></code>. However, often we need to use
the fractional coordinates <code class="docutils literal"><span class="pre">pp.coords_frac</span></code>. This quantity is not present in
the PWscf output and thus <code class="docutils literal"><span class="pre">pp.coords_frac</span></code> will be None. However, we know
that we can manually calculate it from <code class="docutils literal"><span class="pre">coords</span></code> and <code class="docutils literal"><span class="pre">cell</span></code>.</p>
</div>
<div class="section" id="container-classes-structure-and-trajectory">
<span id="container-classes"></span><h2>Container classes <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> and <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a><a class="headerlink" href="#container-classes-structure-and-trajectory" title="Permalink to this headline">¶</a></h2>
<p>In order to abstract away the differences between codes as much as possible, we
have implemented unified container classes. These classes are
<a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> and <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a>. The
former is used to represent a single crystal structure (unit cell, atom
coordinates, total energy, stress tensor, ...). The latter represents a
sequence of structures, for instance an MD or relaxation run.</p>
<p>They have two important features:</p>
<ul class="simple">
<li>A defined set of units
(eV, Angstrom,...), to which all quantities are converted.</li>
<li>Calculate all missing
attributes automatically and thus provide a unified API.</li>
</ul>
<p>Note that the latter is a convenience feature and will also produce some
redundant data. You may want to <a class="reference internal" href="../tutorial.html#avoid-auto-calc"><span class="std std-ref">turn it off</span></a>
for parsing/storing big data.</p>
<p>The auto-calculation of missing properties in <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a>
and <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> is done by trying to calculate all
properties for which there is a <code class="docutils literal"><span class="pre">get_*</span></code> method. For example, if a parser
finds <code class="docutils literal"><span class="pre">coords</span></code> and <code class="docutils literal"><span class="pre">cell</span></code> in the MD data, then in
<a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a> <code class="docutils literal"><span class="pre">coords_frac</span></code> is calculated from that.</p>
<p>You can of course use these classes to build new structures and trajectories by
hand (just as with <code class="docutils literal"><span class="pre">ase.Atoms</span></code>, or you use <a class="reference internal" href="../../generated/api/pwtools.crys.atoms2struct.html#pwtools.crys.atoms2struct" title="pwtools.crys.atoms2struct"><code class="xref py py-func docutils literal"><span class="pre">atoms2struct()</span></code></a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">coords_frac</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">]),</span>
<span class="go">                        cryst_const=np.array([3.0]*3 + [60]*3),</span>
<span class="go">                        symbols=[&#39;Al&#39;,&#39;N&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">coords_frac</span><span class="o">=</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
<span class="go">                         cell=rand(1000,3,3),</span>
<span class="go">                         symbols=[&#39;H&#39;]*20)</span>
</pre></div>
</div>
<p>By doing this, the <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.set_all.html#pwtools.crys.Structure.set_all" title="pwtools.crys.Structure.set_all"><code class="xref py py-meth docutils literal"><span class="pre">set_all()</span></code></a> method is
automatically called, which will calculate all possible attributes from the
input data (for example <code class="docutils literal"><span class="pre">st.coords</span></code>, <code class="docutils literal"><span class="pre">st.cell</span></code>).</p>
<p>However, some attributes may be undefined. For example, the <code class="docutils literal"><span class="pre">st</span></code> above will
have no <code class="docutils literal"><span class="pre">etot</span></code> or <code class="docutils literal"><span class="pre">stress</span></code> attribute (they are None), since that was not
defined in the input and there is no ways to calculate it, of course, whereas a
Structure returned by <a class="reference internal" href="../../generated/api/pwtools.io.read_pw_scf.html#pwtools.io.read_pw_scf" title="pwtools.io.read_pw_scf"><code class="xref py py-func docutils literal"><span class="pre">read_pw_scf()</span></code></a> will have that.</p>
<p>By using the <a class="reference internal" href="../../generated/api/pwtools.base.FlexibleGetters.dump.html#pwtools.base.FlexibleGetters.dump" title="pwtools.base.FlexibleGetters.dump"><code class="xref py py-meth docutils literal"><span class="pre">dump()</span></code></a> method, you can store
the object as binary file [using Python&#8217;s cPickle module] for fast re-loading later:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;struck.pk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_loaded</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;struck.pk&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A Trajectory object can be viewed a list of Structure instances [even though it
is implemented differently due to efficiency: we use 3d numpy arrays], it
supports iteration and slicing, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># extract first and last Structure objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_first</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_last</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># slice out a part of the trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr_middle</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use every 5t step</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span><span class="p">[::</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>Structure and Trajectory objects can also be freely concatenated into a new
Trajectory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tr_new</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr_new</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">st</span><span class="p">,</span> <span class="n">tr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr_new</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">,</span> <span class="n">st</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="high-level-parsing-functions">
<span id="high-level-parsing"></span><h2>High-level parsing functions<a class="headerlink" href="#high-level-parsing-functions" title="Permalink to this headline">¶</a></h2>
<p>The most simple way to parse code output and get a container class is to use
the high-level functions in <a class="reference internal" href="../../generated/api/io.html#module-pwtools.io" title="pwtools.io"><code class="xref py py-mod docutils literal"><span class="pre">io</span></code></a>.</p>
<dl class="docutils">
<dt>These return a <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a>:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cif.html#pwtools.io.read_cif" title="pwtools.io.read_cif"><code class="xref py py-func docutils literal"><span class="pre">read_cif()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pdb.html#pwtools.io.read_pdb" title="pwtools.io.read_pdb"><code class="xref py py-func docutils literal"><span class="pre">read_pdb()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pw_scf.html#pwtools.io.read_pw_scf" title="pwtools.io.read_pw_scf"><code class="xref py py-func docutils literal"><span class="pre">read_pw_scf()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cpmd_scf.html#pwtools.io.read_cpmd_scf" title="pwtools.io.read_cpmd_scf"><code class="xref py py-func docutils literal"><span class="pre">read_cpmd_scf()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_scf.html#pwtools.io.read_cp2k_scf" title="pwtools.io.read_cp2k_scf"><code class="xref py py-func docutils literal"><span class="pre">read_cp2k_scf()</span></code></a></div>
</div>
</dd>
<dt>These return a <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a>:</dt>
<dd><div class="first last line-block">
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pw_md.html#pwtools.io.read_pw_md" title="pwtools.io.read_pw_md"><code class="xref py py-func docutils literal"><span class="pre">read_pw_md()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pw_vcmd.html#pwtools.io.read_pw_vcmd" title="pwtools.io.read_pw_vcmd"><code class="xref py py-func docutils literal"><span class="pre">read_pw_vcmd()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cpmd_md.html#pwtools.io.read_cpmd_md" title="pwtools.io.read_cpmd_md"><code class="xref py py-func docutils literal"><span class="pre">read_cpmd_md()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_md.html#pwtools.io.read_cp2k_md" title="pwtools.io.read_cp2k_md"><code class="xref py py-func docutils literal"><span class="pre">read_cp2k_md()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_md_dcd.html#pwtools.io.read_cp2k_md_dcd" title="pwtools.io.read_cp2k_md_dcd"><code class="xref py py-func docutils literal"><span class="pre">read_cp2k_md_dcd()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_relax.html#pwtools.io.read_cp2k_relax" title="pwtools.io.read_cp2k_relax"><code class="xref py py-func docutils literal"><span class="pre">read_cp2k_relax()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_lammps_md_txt.html#pwtools.io.read_lammps_md_txt" title="pwtools.io.read_lammps_md_txt"><code class="xref py py-func docutils literal"><span class="pre">read_lammps_md_txt()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_lammps_md_dcd.html#pwtools.io.read_lammps_md_dcd" title="pwtools.io.read_lammps_md_dcd"><code class="xref py py-func docutils literal"><span class="pre">read_lammps_md_dcd()</span></code></a></div>
</div>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_pw_scf</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span> <span class="c1"># SCF run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">st</span><span class="o">.</span><span class="n">etot</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_pw_md</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span> <span class="c1"># MD/relax run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">etot</span><span class="p">)</span>
</pre></div>
</div>
<p>These functions use the appropriate parser class and transform the result of
the parsing to a <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> or
<a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a>. For example, what is essentially done is
simply:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same as tr=io.read_pw_md(&#39;pw.out&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">PwMDOutputFile</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># same as st=io.read_cp2k_scf(&#39;cp2k.out&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">Cp2kSCFOutputFile</span><span class="p">(</span><span class="s1">&#39;cp2k.out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">get_struct</span><span class="p">()</span>
</pre></div>
</div>
<p>It is important to note that Structure and Trajectory instances built by hand
can be used in exactly the same way as those obtained by using one of the
<code class="docutils literal"><span class="pre">io.read_*()</span></code> functions.</p>
</div>
<div class="section" id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this headline">¶</a></h2>
<p>Each parser will (try to) return the &#8220;natural&#8221; units of each code:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="12%" />
<col width="21%" />
<col width="25%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">PWscf</th>
<th class="head">CPMD</th>
<th class="head">CP2K</th>
<th class="head">LAMMPS (metal units)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>length</td>
<td>Bohr</td>
<td>Bohr</td>
<td>Angstrom</td>
<td>Angstrom</td>
</tr>
<tr class="row-odd"><td>energy</td>
<td>Ry</td>
<td>Ha</td>
<td>Ha</td>
<td>eV</td>
</tr>
<tr class="row-even"><td>forces</td>
<td>Ry/Bohr</td>
<td>Ha/Bohr</td>
<td>Ha/Bohr</td>
<td>eV/Angstrom</td>
</tr>
<tr class="row-odd"><td>stress</td>
<td>kbar</td>
<td>kbar</td>
<td>bar[MD], GPa[SCF]</td>
<td>bar</td>
</tr>
<tr class="row-even"><td>temperature</td>
<td>K</td>
<td>K</td>
<td>K</td>
<td>K</td>
</tr>
<tr class="row-odd"><td>velocity</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>Bohr/thart (?)</td>
<td>Bohr/thart</td>
<td>Angstrom/ps</td>
</tr>
<tr class="row-even"><td>time</td>
<td>tryd</td>
<td>thart</td>
<td>thart</td>
<td>ps</td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="../../generated/api/constants.html#module-pwtools.constants" title="pwtools.constants"><code class="xref py py-mod docutils literal"><span class="pre">constants</span></code></a> for <cite>thart</cite> and <cite>tryd</cite>.</p>
<p>For PWscf, we also detect things like &#8220;ATOMIC_POSITIONS crystal | alat | bohr&#8221;
and transform accordingly. Nevertheless, <em>always</em> verify that the units you get
are the ones you expect!</p>
<p>In <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a> and <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal"><span class="pre">Trajectory</span></code></a>, we have
units eV, Angstrom,...</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="25%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">property</th>
<th class="head">unit</th>
<th class="head">SI</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>length</td>
<td>Angstrom</td>
<td>(1e-10 m)</td>
</tr>
<tr class="row-odd"><td>energy</td>
<td>eV</td>
<td>(1.602176487e-19 J)</td>
</tr>
<tr class="row-even"><td>forces</td>
<td>eV / Angstrom</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>stress</td>
<td>GPa</td>
<td>(not eV/Angstrom**3)</td>
</tr>
<tr class="row-even"><td>temperature</td>
<td>K</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>velocity</td>
<td>Angstrom / fs</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>time</td>
<td>fs</td>
<td>(1e-15 s)</td>
</tr>
<tr class="row-odd"><td>mass</td>
<td>amu</td>
<td>(1.6605387820000001e-27 kg)</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../install.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="param_study.html" title="Parameter studies"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pwtools  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Features</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Steve Schmerler.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>