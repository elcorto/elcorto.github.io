
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Radial Basis Functions Networks for interpolation or fitting of N-dim data points &#8212; pwtools  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="radial-basis-functions-networks-for-interpolation-or-fitting-of-n-dim-data-points">
<span id="rbf"></span><h1>Radial Basis Functions Networks for interpolation or fitting of N-dim data points<a class="headerlink" href="#radial-basis-functions-networks-for-interpolation-or-fitting-of-n-dim-data-points" title="Permalink to this headline">¶</a></h1>
<p>Some background information on the method implemented in
<a class="reference internal" href="../../generated/api/rbf.html#module-pwtools.rbf" title="pwtools.rbf"><code class="xref py py-mod docutils literal"><span class="pre">rbf</span></code></a>. For code examples, see the docstring of
<a class="reference internal" href="../../generated/api/pwtools.rbf.RBFInt.html#pwtools.rbf.RBFInt" title="pwtools.rbf.RBFInt"><code class="xref py py-class docutils literal"><span class="pre">RBFInt</span></code></a> and <code class="docutils literal"><span class="pre">examples/rbf/</span></code>.</p>
<p>Refs:</p>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Radial_basis_function_network">http://en.wikipedia.org/wiki/Radial_basis_function_network</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Numerical Recipes, 3rd ed., ch 3.7</td></tr>
</tbody>
</table>
<div class="section" id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h2>
<p>The goal is to interpolate or fit an unordered set of <span class="math">\(M\)</span> ND data points
<span class="math">\(\mathbf x_i\)</span> and values <span class="math">\(z_i\)</span> so as to obtain <span class="math">\(z=f(\mathbf
x)\)</span>. In radial basis function (RBF) interpolation, the interpolating function
<span class="math">\(f(\mathbf x)\)</span> is a linear combination of RBFs <span class="math">\(\phi(r)\)</span></p>
<div class="math">
\[f(\mathbf x) = \sum_j w_j\,\phi(|\mathbf x - \mathbf c_j|)\]</div>
<p>with the weights <span class="math">\(w_j\)</span> and the center points <span class="math">\(\mathbf c_j\)</span>. An RBF
<span class="math">\(\phi(r)\)</span> is thus a function of the distance <span class="math">\(r=|\mathbf x -
\mathbf c_j|\)</span> between <span class="math">\(\mathbf x\)</span> and a center point. Common functions
include</p>
<div class="math">
\[\begin{split}\begin{align}
    &amp; \phi(r) = \exp\left(-\frac{r^2}{2\,p^2}\right) &amp;&amp; \text{Gaussian}\\
    &amp; \phi(r) = \sqrt{r^2 + p^2} &amp;&amp; \text{multiquadric}\\
    &amp; \phi(r) = \frac{1}{\sqrt{r^2 + p^2}} &amp;&amp; \text{inverse multiquadric}
\end{align}\end{split}\]</div>
<p>All RBFs contain a single parameter <span class="math">\(p\)</span> which defines the width of the
function. The function <span class="math">\(f(\mathbf x)\)</span> can be also thought of as a neural network
with one hidden layer and activation functions
<span class="math">\(\phi\)</span>.</p>
<p>In interpolation the center points <span class="math">\(\mathbf c_j\)</span> are equal to the data points
<span class="math">\(\mathbf x_j\)</span> such that</p>
<div class="math">
\[\begin{split}\begin{gather}
    z_i = f(\mathbf x_i) = \sum_j w_j\,\phi(|\mathbf x_i - \mathbf x_j|) = \sum_j w_j\,G_{ij}\\
    \mathbf G\,\mathbf w = \mathbf z\\
\end{gather}\end{split}\]</div>
<p>with <span class="math">\(\mathbf G\)</span> the <span class="math">\(M\times M\)</span> matrix of RBF function values. The
weights <span class="math">\(\mathbf w = (w_j)\)</span> are found by solving the linear system</p>
<div class="math">
\[\mathbf w = \mathbf G^{-1}\,\mathbf z\]</div>
<p>Thus, the applicability of the method is limited by the number of points
<span class="math">\(M\)</span> in the sense that a dense linear system <span class="math">\(M\times M\)</span> must be
stored and solved. For large point sets, the calculation of the distance matrix
<span class="math">\(R_{ij} = |\mathbf x_i - \mathbf x_j|\)</span> is one of the bottlenecks. In
pwtools, this is coded in Fortran (see <a class="reference internal" href="../../generated/api/pwtools.num.distsq.html#pwtools.num.distsq" title="pwtools.num.distsq"><code class="xref py py-func docutils literal"><span class="pre">distsq()</span></code></a>).</p>
</div>
<div class="section" id="rbf-parameter">
<h2>RBF parameter <span class="math">\(p\)</span><a class="headerlink" href="#rbf-parameter" title="Permalink to this headline">¶</a></h2>
<p>Each RBF has a single “width” parameter <span class="math">\(p\)</span>, which can be tuned (attribute
<code class="docutils literal"><span class="pre">param</span></code> in the code). While <span class="math">\(f(\mathbf x)\)</span> goes through all data points
<span class="math">\(\mathbf x_i\)</span> by definition, the behavior of the interpolation between
points is determined by <span class="math">\(p\)</span>. For instance, too narrow functions
<span class="math">\(\phi\)</span> can lead to oscillations between points. Therefore <span class="math">\(p\)</span> must
be tuned for the specific data set. A good estimate for <span class="math">\(p\)</span> in many cases
is the mean distance <span class="math">\(p=1/M^2\,\sum_{ij} R_{ij}\)</span>
(<code class="docutils literal"><span class="pre">RBFInt.get_param(param='est')</span></code>). While the Gaussian RBF is rather sensitive
to the value of <span class="math">\(p\)</span>, the multiquadric and inverse multiquadric functions
provide stable interpolation results for a wide range of <span class="math">\(p\)</span> values.</p>
<p>In general, <span class="math">\(p\)</span> should be determined by methods such as K-fold cross
validation, which is outside the scope of pwtools. See <code class="docutils literal"><span class="pre">scikit-learn</span></code> for
more.</p>
</div>
<div class="section" id="interpolation-vs-fitting">
<h2>Interpolation vs. fitting<a class="headerlink" href="#interpolation-vs-fitting" title="Permalink to this headline">¶</a></h2>
<p>For smooth noise-free data, RBF works perfect. But for noisy data, we would
like to do a fit instead, like the “s” parameter to
<code class="docutils literal"><span class="pre">scipy.interpolate.bisplrep</span></code>. <code class="docutils literal"><span class="pre">scipy.interpolate.Rbf</span></code> has a “smooth”
parameter <span class="math">\(\lambda\)</span> for regularization</p>
<div class="math">
\[\mathbf w = (\mathbf G^{-1} + \lambda\,\mathbf I)\,\mathbf z\]</div>
<p>We found that <code class="docutils literal"><span class="pre">scipy.linalg.solve</span></code> often gives an ill-conditioned matrix
warning, which shows numerical instability and results in bad interpolation. In
that case, one can use regularization which (i) adds numerical stability and
(ii) creates a more “stiff” (low curvature) function which does not interpolate
all points.</p>
<p>One can also switch from <code class="docutils literal"><span class="pre">scipy.linalg.solve</span></code> to <code class="docutils literal"><span class="pre">scipy.linalg.lstsq</span></code> and
solve the system in a least squares sense, in which case we also get much more
stable solutions. The advantage of using least squares is that we have the
smoothness by construction no smoothness parameter needs to be tuned.</p>
<p>If the noise is low relative to the point distance, we get interpolation-like
results, which cannot be distinguished from the solutions obtained with a
normal linear system solver. The method will try its best to do interpolation,
but will smoothly transition to fitting as noise increases, which is what we
want. Hence, lstsq is the default solver.</p>
</div>
<div class="section" id="other-codes">
<h2>Other codes<a class="headerlink" href="#other-codes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">scipy.interpolate.Rbf</span></code>
Essentially the same as we do. We took some ideas from there.</li>
<li><a class="reference external" href="http://pypi.python.org/pypi/PyRadbas/0.1.0">http://pypi.python.org/pypi/PyRadbas/0.1.0</a>
Seems to work with Gaussians hardcoded. Not what we want.</li>
<li><a class="reference external" href="http://code.google.com/p/pyrbf/">http://code.google.com/p/pyrbf/</a>
Seems pretty useful for large problems (many points), but not
documented very much.</li>
</ul>
</div>
<div class="section" id="input-data">
<h2>Input data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h2>
<p>It usually helps if all data ranges (points X and values Y) are in the same
order of magnitude, e.g. all have a maximum close to unity or so. If, for
example, X and Y have very different scales (say X -0.1 .. 0.1 and Y
0…1e4), you may get bad interpolation between points. This is b/c the RBFs
also live on more or less equal x-y scales.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">pwtools</h1>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=elcorto&repo=pwtools&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../generated/api/index.html">API Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Background, details, special topics</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Steve Schmerler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../../_sources/written/background/rbf.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>